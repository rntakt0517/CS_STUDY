# 입출력 장치의 특성

입출력 장치는 CPU나 메모리에 비해 다루기가 까다롭습니다. 그 이유는 다음과 같습니다:

1. **다양성**:
   
   - 입출력 장치의 종류가 매우 다양함 (예: 마우스, 키보드, 모니터, 스피커 등)
   - 같은 종류의 장치라도 제조사마다 다른 모양과 데이터 전송 형식을 가짐

2. **규격화 어려움**:
   
   - 장치마다 속도와 데이터 전송 방식이 다양해 규격화하기 어려움
   - CPU와 메모리가 모든 입출력 장치의 특성을 알기 어려움

3. **전송률 차이**:
   
   - 일반적으로 CPU와 메모리의 데이터 전송률이 입출력 장치보다 높음
   - 전송률 차이로 인해 효율적인 데이터 교환이 어려움

## 장치 컨트롤러

장치 컨트롤러는 이러한 문제를 해결하기 위해 등장한 하드웨어입니다.

- **정의**: 입출력 장치와 컴퓨터 내부 간 통신을 중개하는 하드웨어
- **별칭**: 입출력 제어기, I/O 모듈

## 역할

1. **CPU와 입출력 장치 간 통신 중개**:
   
   - 다양한 입출력 장치의 특성을 CPU와 메모리가 이해할 수 있게 변환
   - 일종의 "통역사" 역할 수행

2. **입출력 장치 오류 검출**:
   
   - 연결된 입출력 장치의 문제를 감지하고 보고

3. **데이터 버퍼링 제공**:
   
   - 전송률이 다른 장치 간 데이터 전송을 원활하게 하기 위해 임시 저장 공간(버퍼) 제공
   - 예: CPU로부터 받은 빠른 데이터를 버퍼에 저장했다가 느린 입출력 장치에 맞춰 전송

## 내부 구조

장치 컨트롤러는 다음과 같은 레지스터들로 구성됩니다:

- **데이터 레지스터**: 주고받을 데이터 저장
- **상태 레지스터**: 입출력 장치의 상태 정보 저장 (예: 준비 완료, 작업 중, 오류 발생 등)
- **제어 레지스터**: 수행할 동작 정보 저장

## 장치 드라이버

- **정의**: 장치 컨트롤러의 동작을 감지하고 제어하는 프로그램
- **역할**: 소프트웨어적 통로 제공

## 특징

- 새로운 장치 연결 시 필요
- 장치 드라이버가 없으면 해당 입출력 장치 사용 불가
- 장치 드라이버가 설치되면 컴퓨터가 해당 장치를 인식하고 동작 가능

**예시) 프린터 연결 시**:

1. 프린터를 컴퓨터에 물리적으로 연결
2. CPU가 프린터 장치 컨트롤러 동작 방식을 모름
3. 장치 드라이버 설치로 CPU에 프린터 동작 방법 전달
4. 컴퓨터와 프린터 간 정보 교환 가능

## 입출력 방식

## 1. 프로그램 입출력

- CPU가 장치 컨트롤러의 레지스터 값을 직접 읽고 씀
- **메모리 맵 입출력**과 **고립형 입출력** 두 가지 방식 존재

## 메모리 맵 입출력

- 메모리와 입출력 장치가 같은 주소 공간 사용
- 별도의 입출력 명령어 불필요
- 메모리 주소 공간 축소 단점

## 고립형 입출력

- 메모리와 입출력 장치가 분리된 주소 공간 사용
- 입출력 전용 명령어 필요 (예: x86 CPU의 IN, OUT 명령어)
- 메모리 주소 공간 축소 없음

## 2. 인터럽트 기반 입출력

- 장치 컨트롤러가 CPU에 인터럽트 요청 신호 전송
- CPU 사이클 효율적 관리 가능

## 다중 인터럽트 처리

1. 순차적 처리:
   
   - 인터럽트 발생 순서대로 처리
   - CPU의 플래그 레지스터 내 인터럽트 비트 비활성화하여 다른 인터럽트 차단

2. 우선순위 반영 처리:
   
   - 중요도에 따라 인터럽트 처리 순서 결정
   - 높은 우선순위 인터럽트는 현재 처리 중인 인터럽트 중단 가능

**예시) PIC (Programmable Interrupt Controller)**

- 여러 장치 컨트롤러의 인터럽트 우선순위 판단
- CPU에 처리할 인터럽트 알림
- NMI (Non-Maskable Interrupt) 제외한 하드웨어 인터럽트 우선순위 관리

## 3. DMA (Direct Memory Access) 입출력

- CPU를 거치지 않고 메모리와 입출력 장치 간 직접 데이터 전송
- DMA 컨트롤러가 입출력 작업 대행

## DMA 입출력 과정

1. CPU가 DMA 컨트롤러에 입출력 작업 명령
2. DMA 컨트롤러가 장치 컨트롤러와 상호작용하며 입출력 작업 수행
3. 필요시 DMA 컨트롤러가 메모리에 직접 접근
4. 작업 완료 후 DMA 컨트롤러가 CPU에 인터럽트로 알림

**사이클 스틸링 (Cycle Stealing)**:

- DMA 컨트롤러가 CPU의 메모리 접근 사이클을 일시적으로 사용하는 기법
- CPU의 작업을 최소한으로 방해하며 DMA 작업 수행

## 입출력 버스

- 장치 컨트롤러를 시스템 버스 대신 입출력 전용 버스에 연결
- 시스템 버스 점유 시간 감소
- **예시) PCI 버스, PCI Express 버스**

## 최신 동향

- 입출력 전용 프로세서 (입출력 채널) 사용
- 입출력 장치에 RAM이나 전용 CPU 탑재
- 예: 듀얼코어 CPU를 탑재한 프린터
